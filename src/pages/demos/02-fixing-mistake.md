## Demo 02 - Git history & Git blame & Undoing mistake
### Overview

#### Git history
git เก็บข้อมูลเป็น series ของ commit และแต่ละ commit ก็มีข้อมูลอื่นๆไม่ว่าจะเป็น author, วันที่ และ commit message ทำให้เราสามารถมาดู history และรู้ได้เลยว่าใคร ทำอะไร เมื่อไหร่ เพราะอะไร ลำดับของเหตุการณ์ เหตุการณ์ไหนก็ก่อนเกินหลัง git client แต่ละตัวสามารถใช้ดู history ได้หมด แนะนำว่าใช้ GUI พวก source tree

#### Git blame
git blame เป็นคำสั่งเพื่อที่จะดูว่าในแต่ละบรรทัดใครเป็นคนแก้และแก้ไปเมื่อไหร่ คำสั่งนี้เราใช้กันอยู่ตลอดแค่เราไม่ได้พิมกันเอง เช่น ถ้าใครใช้ extension git len ใน vscode ชึ่งจะบอกเลยว่าบรรทัดนี้ถูกแก้ไปเมื่อไหร่ โดยใคร ประโยชน์ คือ เวลามีปัญหาเราไล่สิ่งที่เราควรดูเป็นสิ่งแรกๆเลยคือ change ล่าสุดที่เกิดขึ้น
#### Undoing mistake
บางครั้งเราอาจจะเผลอ commit งานที่ไม่ถูกต้องหรือไม่เสร็จสมบูรณ์ หรือ อาจจะเป็นงานที่เราไม่ต้องการใช้แล้ว เราก็สามารถลบงาน หรือ commit นั้นออกได้ โดยจะมี 2 แนวทางด้วยกัน แต่ละอันก็จะมีข้อดีและข้อเสียที่แตกต่างกัน

1. **ลบ commit เหล่านั้นออกไปเลย**
   
   ในรูปแบบนี้คือการทำให้ commit นั้นหายไปจาก history เลย ทำให้สิ่งนั้นเหมือนกับไม่เคยเกิดขึ้นมากก่อน วิธีนี้แนะนำว่าใช้เฉพาะกับงานที่อยู่ในเครื่องตัวเองหรือเป็น branch ของตัวเองเป็นหลัก เพราะการทำให้ history หายไปอาจมีผลกระทบกับงานของคนอื่นได้ และ การที่เราจะกู้งานที่เราลบกลับมานั้นเป็นไปได้ยากมาก สามารถทำได้ด้วยคำสั่ง 
   ```
   git reset <COMMIT_ID>
   ```
   **ข้อดี**
   - commit นั้นจะหายไปเลย ทำให้ history ของเรานั้นดู clean กว่า

   **ข้อเสีย**
   - ไม่สามารถกู้งานกลับมาได้
   - อาจมีผลกระทบกับงานของคนอื่น

   **Note** git reset การทำการลบ commit ล่าสุดถึง commit ที่เราใส่ไป การที่เราจะลบ commit ที่อยู่ตรงกลางเราจะไปใช้คำสั่ง rebase (เดียวมีหลังจากนี้)
2. **การ revert change**
   
   การ revert นั้นจะเป็นการ commit ใหม่ ซึ่ง commit ใหม่นั้นจะมีผลตรงข้ามกับ commit ที่เราต้องการจะลบเช่น ถ้าเราทำการลบไฟล์ไปใน commit ที่เราจะลบ commit ใหม่ที่เกิดขึ้นจะทำการเพิ่มไฟล์นั้นเข้ามาใหม่ หรือ ถ้า commit ที่เราจะลบทำการลบข้อมูลบางส่วนในไฟล์ commit ใหม่ก็จะทำการเพิ่มข้อมูลเหล่านั้นเข้ามาในไฟล์ แนะนำว่าควรทำท่านี้มากกว่า สามารถทำได้ด้วยคำสั่ง 
   ```
   git revert <COMMIT_ID>
   ```
  
   **ข้อดี**
   - เห็นชัดเจนว่ามีการ revert change
   - สามารถกู้งานกลับมาได้

   **ข้อเสีย**
   - history จะมี commit เยอะขึ้นทำให้เวลาอ่านอาจจะใช้เวลามากหรืองงได้

### ขั้นตอนการทำ
1. Checkout to a new branch.
   ```
   git checkout -b demo-02-fixing-mistake-${nickname} origin/demo-02-fixing-mistake
   ```
2. ลองดู commit ใน branch นี้
3. จะเห็นว่ามี commit ที่ชื่อว่า `Unwanted commit`
4. ลองใช้คำสั่ง `git revert <commit id>` ของ `Unwanted commit`
5. ลองดูว่า git ทำอะไรให้เราบ้างดู **history**, **changes** และ **commit message**
6. หลังจากนั้นลอง reset ทั้ง `Unwanted commit` และ `Revert commit` ด้วยคำสั่ง
   ```
   git reset <commit id ก่อนหน้า Unwanted commit>
   ```
7. เอา change ที่ reset ที่อยู่ใน working ออก
   ```
   git restore <path to file>
   ```
8. ถ้าจะ push ต้องใช้คำสั่ง push -f เพราะเรามีการลบ commit